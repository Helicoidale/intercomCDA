{% extends 'base.html.twig' %}

{% block title %}liste des plannings{% endblock %}

{% block body %}
    <h3>les plannings d'astreintes:  {{ premierJourDuMois|format_datetime( pattern=" MMMM y", locale='fr') }}</h3>
    {% if is_granted('ROLE_EDITOR') %}
    <div class="row">

{#        <div class="col-md-4">#}
{#            <a href="#" class="btn  btn-primary">rechercher </a> <br><br>#}
{#        </div>#}


        <div class="col-md-4">
            <a href="{{ path('gardes_table_des_matiere') }}" class="btn  btn-primary">ajouter ou modifier</a><br><br>
        </div>
        <div class="col-md-4">
            <a href="{{ path('home') }}" class="btn  btn-primary">retour </a>
        </div>
    </div>
    {% endif %}

    <div class="d-flex flex-row align-items-center justify-content-between mx-sm">

        <div>

            <a href="{{ path ('planning_index',{ 'month' : calendrier.previousMonth.month ,'year' : calendrier.previousMonth.year}) }}" class="btn btn-primary">&lt;</a>
            <a href="{{ path ('planning_index',{ 'month' : calendrier.nextMonth.month ,'year' : calendrier.nextMonth.year}) }}" class="btn btn-primary">&gt;</a>

        </div>

    </div>
    <table class="table">
        <thead>
        <tr>

            <th>date :</th>
            {% for uniteSoin in unitesSoins %}
                <th>{{ uniteSoin.nom }}<br>{{ uniteSoin.getDescription }}</th>
            {% endfor %}
        </tr>
        </thead>
        <tbody>


        {% for i in range(0,nbreJourDuMois-1) %}
            <tr>


                <td>
                    {% set date =premierJourDuMois|date_modify('+ '~(i)~ 'day' ) %}

                    {{ date|format_datetime( pattern="EEEE d MMMM y", locale='fr') }}

                </td>
                {% for uniteSoin in unitesSoins %}
                    <td>
                        {# pour chaque unite#}

                        {% set dateSansJour=date|format_datetime(pattern='y-MM-dd') %}

                        {% if days[(dateSansJour)] is defined %}

                            {% if days[(dateSansJour)][(uniteSoin.id)] is defined %}


                                {% for u in days[(dateSansJour)][uniteSoin.id] %}
                                    {#                                        {{ u.uniteSoin.nom }}#}
                                    {{ u.responsable.getnom }}
                                    <br>
                                    {% if  u.dateHeureDebut |date('H:i')   == "00:00" %}
                                    {% else %}
                                        à partir de : {{ u.dateHeureDebut ? u.dateHeureDebut|date( 'H:i') : '' }} h
                                    {% endif %}
                                    <br>
                                    {% if  u.dateTimeFin |date('H:i')   == "23:59" %}
                                    {% else %}
                                        jusqu'à : {{ u.dateTimeFin ? u.dateTimeFin|date('H:i') : '' }} h
                                    {% endif %}
                                    <br>
                                {% endfor %}

                            {% endif %}
                        {% endif %}


                    </td>
                {% endfor %}
            </tr>
        {% endfor %}

        </tbody>
    </table>

{#    <a href="{{ path('planning_new') }}" class="btn btn-primary">Ajouter</a>#}
{#    <a href="{{ path('gardes_table_des_matiere') }} " class="btn btn-primary">Retour</a>#}
{#   <a href="{{ path('planning_index') }} " class="btn btn-primary"  id="imprimer" name="imprimer" value="imprimer">imprimer</a>#}
<form method="get">
  <input type="submit" class="btn  btn-primary" id="imprimer" name="imprimer" value="imprimer">
</form>
    <a href="{{ path('home') }}" class="btn  btn-primary">retour </a>
{% endblock %}
